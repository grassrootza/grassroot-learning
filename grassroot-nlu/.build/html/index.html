<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Welcome to Grassroot-NLU’s documentation! &#8212; Grassroot-nlu 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="welcome-to-grassroot-nlu-s-documentation">
<h1>Welcome to Grassroot-NLU&#8217;s documentation!<a class="headerlink" href="#welcome-to-grassroot-nlu-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
<p>Grassroot-nlu is an nlu engine trained for parsing through common Grassroot user
input and extracting intent and entities from said text.</p>
<div class="section" id="getting-started-with-grassroot-nlu">
<h2>Getting Started with Grassroot-NLU<a class="headerlink" href="#getting-started-with-grassroot-nlu" title="Permalink to this headline">¶</a></h2>
<p>There are multiple ways one could get the server up. A popular option is
building a docker image from this current directories parent directory (which
should contain a <code class="file docutils literal"><span class="pre">Dockerfile</span></code>). Open a terminal and run</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo docker build -t grassroot-nlu .
</pre></div>
</div>
<p>Please be aware of the &#8216;.&#8217; at the end of the above command. It is a necessary
part of the command.</p>
<p>Building a docker image will download necessary dependencies and behave
predictably. Before running the image, make sure to have the necessary aws access
key id and aws secret key which should be passed as environment variables
when running the image, like so</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo docker run -e AWS_ACCESS_KEY_ID=&#39;ACCESSKEYVALUE&#39; -e AWS_SECRET_ACCESS_KEY=&#39;SECRETKEYVALUE&#39; -p 5000:80 grassroot-nlu
</pre></div>
</div>
<p>This runs a docker container exposing port 80, mapped to port 5000.</p>
<p>Alternatively, if you prefer a docker free environment, then simply open a terminal
in the directory containing <code class="file docutils literal"><span class="pre">main.py</span></code> and run</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ bash depends.sh
</pre></div>
</div>
<p>which will download and install all necessary dependencies and follow it up
with</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python3 main.py
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This alternative installation only works on Linux systems, preferably Ubuntu
16.04 with Python 3</p>
</div>
</div>
<div class="section" id="demo-client">
<h2>Demo Client<a class="headerlink" href="#demo-client" title="Permalink to this headline">¶</a></h2>
<p>For your convenience and as an example a demo client is provided below</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">base_url</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter base url: &#39;</span><span class="p">)</span>
<span class="n">uid</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">emulate</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">uid</span>
    <span class="c1"># SECTION 1</span>
    <span class="c1"># Request sent: call a vote</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">SECTION 1&#39;</span><span class="p">)</span>
    <span class="n">raw</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/parse?text=call a vote&amp;uid=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">uid</span><span class="p">))</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
    <span class="n">ret_val</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ret_val</span><span class="p">)</span>
    <span class="n">uid</span> <span class="o">=</span> <span class="p">(</span><span class="n">ret_val</span><span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">])</span>
    <span class="c1"># SECTION 2</span>
    <span class="c1"># Request sent: tomorrow</span>
    <span class="c1"># Tells the engine to look for text with certain uid</span>
    <span class="c1"># in this case that text is &#39;call a vote&#39;.</span>
    <span class="c1"># once text is found the value added below, &#39;tomorrow&#39; is appended</span>
    <span class="c1"># and the new text value is sent for parsing and returned.</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">SECTION 2&#39;</span><span class="p">)</span>
    <span class="n">raw</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/parse?text=tomorrow&amp;uid=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">uid</span><span class="p">))</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
    <span class="n">ret_val</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ret_val</span><span class="p">)</span>
    <span class="n">uid</span> <span class="o">=</span> <span class="p">(</span><span class="n">ret_val</span><span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">])</span>
    <span class="c1"># SECTION 3</span>
    <span class="c1"># In this case though the uid passed to the api points to the text &#39;call a vote tomorrow&#39; created</span>
    <span class="c1"># by the first two sections, the uid and its associated text are ignored.</span>
    <span class="c1"># This is thanks to process identifier that identifies what is to be done with</span>
    <span class="c1"># recieved text. In this case it would recognize the text below as a new entry</span>
    <span class="c1"># and disregard any uid recieved with request.</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">SECTION 3&#39;</span><span class="p">)</span>
    <span class="n">raw</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/parse?text=find me volunteers for a protest this friday&amp;uid=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">uid</span><span class="p">))</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
    <span class="n">ret_val</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ret_val</span><span class="p">)</span>
    <span class="n">uid</span> <span class="o">=</span> <span class="p">(</span><span class="n">ret_val</span><span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">])</span>

<span class="n">emulate</span><span class="p">()</span>
</pre></div>
</div>
<p>copy and paste this code in a file which we will call <code class="file docutils literal"><span class="pre">demo_client.py</span></code>.
then run the file with</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python3 demo_client.py
</pre></div>
</div>
<p>This will prompt you to enter a base url. If you running Grassroot-NLU from a
docker conatiner and have used the above port mapping then enter <code class="file docutils literal"><span class="pre">http://localhost:5000</span></code>
This will also work where the engine is started from running <code class="file docutils literal"><span class="pre">python3</span> <span class="pre">main.py</span></code></p>
<p>If you have hosted it online somewhere then enter the base domain and path to the engine prior
to <code class="file docutils literal"><span class="pre">/parse</span></code>.</p>
<p>The demo client will demonstate how to implement dynamic text construction as well as how
to pass general queries to the engine.</p>
</div>
<div class="section" id="output">
<h2>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>The basic output for a request like <code class="file docutils literal"><span class="pre">call</span> <span class="pre">a</span> <span class="pre">meeting</span> <span class="pre">tomorrow</span></code> is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">&quot;parsed&quot;</span><span class="p">:</span> <span class="p">{</span>
  <span class="s2">&quot;intent&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;call_meeting&quot;</span><span class="p">,</span>
   <span class="s2">&quot;confidence&quot;</span><span class="p">:</span> <span class="mf">0.0</span>
  <span class="p">},</span>
  <span class="s2">&quot;entities&quot;</span><span class="p">:</span> <span class="p">[</span>
   <span class="p">{</span>
    <span class="s2">&quot;entity&quot;</span><span class="p">:</span> <span class="s2">&quot;datetime&quot;</span><span class="p">,</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY-MM-DDTHH:MM&quot;</span><span class="p">,</span>
    <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
    <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="mi">23</span>
   <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;call a meeting tomorrow&quot;</span>
 <span class="p">},</span>
 <span class="s2">&quot;uid&quot;</span><span class="p">:</span> <span class="s2">&quot;8e8df664-32ab-xxxx-a896-0f650rtn92x0&quot;</span><span class="p">,</span>
 <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-08-07 15:45:24.127244&quot;</span><span class="p">,</span>
 <span class="s2">&quot;past_lives&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>All output conforms to this basic structure with variable intents and entities.</p>
</div>
<div class="section" id="module-main">
<span id="core-functions"></span><h2>Core Functions<a class="headerlink" href="#module-main" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="main.add_detail_to_previous_text_state">
<code class="descclassname">main.</code><code class="descname">add_detail_to_previous_text_state</code><span class="sig-paren">(</span><em>new_value</em>, <em>uid</em><span class="sig-paren">)</span><a class="headerlink" href="#main.add_detail_to_previous_text_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when a process is identified with the &#8216;update&#8217; intent.
searches database for text with uid and appends new_value to it. It
then sends it for parsing and returns output</p>
</dd></dl>

<dl class="function">
<dt id="main.add_detail_to_text">
<code class="descclassname">main.</code><code class="descname">add_detail_to_text</code><span class="sig-paren">(</span><em>text</em>, <em>uid</em><span class="sig-paren">)</span><a class="headerlink" href="#main.add_detail_to_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when a process is identified with the &#8216;update&#8217; intent.
searches database for text with uid and appends new_value to it. It
then sends it for parsing and returns output</p>
</dd></dl>

<dl class="function">
<dt id="main.displayLogs">
<code class="descclassname">main.</code><code class="descname">displayLogs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#main.displayLogs" title="Permalink to this definition">¶</a></dt>
<dd><p>tails the log file</p>
</dd></dl>

<dl class="function">
<dt id="main.formalizer_helper">
<code class="descclassname">main.</code><code class="descname">formalizer_helper</code><span class="sig-paren">(</span><em>time_string</em><span class="sig-paren">)</span><a class="headerlink" href="#main.formalizer_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>time_formalizer&#8217;s helper. Responsible for sending out api requests</p>
</dd></dl>

<dl class="function">
<dt id="main.index">
<code class="descclassname">main.</code><code class="descname">index</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#main.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Renders the home page.</p>
</dd></dl>

<dl class="function">
<dt id="main.parse_rest">
<code class="descclassname">main.</code><code class="descname">parse_rest</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#main.parse_rest" title="Permalink to this definition">¶</a></dt>
<dd><p>Main entry point. API path is &#8216;/parse?text=query&#8217;, where query is the text you want parsed.</p>
</dd></dl>

<dl class="function">
<dt id="main.parser">
<code class="descclassname">main.</code><code class="descname">parser</code><span class="sig-paren">(</span><em>text</em>, <em>uid</em>, <em>date_time</em>, <em>past_life</em><span class="sig-paren">)</span><a class="headerlink" href="#main.parser" title="Permalink to this definition">¶</a></dt>
<dd><p>This function handles the nlu parsing. It first extracts intent and
if nature of intent requires entity extraction the text is then parsed 
by a secondary extractor. It also formalises informal datetime strings</p>
</dd></dl>

<dl class="function">
<dt id="main.process_gateway">
<code class="descclassname">main.</code><code class="descname">process_gateway</code><span class="sig-paren">(</span><em>text_to_parse</em><span class="sig-paren">)</span><a class="headerlink" href="#main.process_gateway" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is responsible for assigning uids to new texts and saving text to db,
sending them for parsing and returning them. Before parsing it will
check database for requested text and if it already exists it is returned.</p>
</dd></dl>

<dl class="function">
<dt id="main.process_identifier">
<code class="descclassname">main.</code><code class="descname">process_identifier</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span><a class="headerlink" href="#main.process_identifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies where a process will go. This process produces a certain amount of
redundancy and is most like to change or be deprecated soon.</p>
</dd></dl>

<dl class="function">
<dt id="main.save_as_training_instance">
<code class="descclassname">main.</code><code class="descname">save_as_training_instance</code><span class="sig-paren">(</span><em>uid</em><span class="sig-paren">)</span><a class="headerlink" href="#main.save_as_training_instance" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns all affirmed parsed values into training data.</p>
</dd></dl>

<dl class="function">
<dt id="main.time_formalizer">
<code class="descclassname">main.</code><code class="descname">time_formalizer</code><span class="sig-paren">(</span><em>parsed_data</em><span class="sig-paren">)</span><a class="headerlink" href="#main.time_formalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Formalises datetime values recieved from parser() by extracting target value from parsed
text and sending it to formalizer_helper()</p>
</dd></dl>

<dl class="function">
<dt id="main.update_database">
<code class="descclassname">main.</code><code class="descname">update_database</code><span class="sig-paren">(</span><em>new_data</em><span class="sig-paren">)</span><a class="headerlink" href="#main.update_database" title="Permalink to this definition">¶</a></dt>
<dd><p>updates database with new_data from parser. This is the database
process_gateway() searches for past entries that are suitable to be returned</p>
</dd></dl>

<span class="target" id="module-config"></span><dl class="function">
<dt id="config.configure">
<code class="descclassname">config.</code><code class="descname">configure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#config.configure" title="Permalink to this definition">¶</a></dt>
<dd><p>Main configuration automator. Responsible for call other configuration functions.
Tries configuring nlu engine in current state, downloads models from s3 if absent,
trains new models locally on host if s3 models cannot be obtained.</p>
</dd></dl>

<dl class="function">
<dt id="config.load_interpreters">
<code class="descclassname">config.</code><code class="descname">load_interpreters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#config.load_interpreters" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads interpreters and their respective metadatas</p>
</dd></dl>

<dl class="function">
<dt id="config.train_models">
<code class="descclassname">config.</code><code class="descname">train_models</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#config.train_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Activates training_data_maker.py and uploads generated model to s3 if 
internet connection exists.</p>
</dd></dl>

<dl class="function">
<dt id="config.try_download_models">
<code class="descclassname">config.</code><code class="descname">try_download_models</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#config.try_download_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to download models from s3 and calls train_models if unsuccessful.</p>
</dd></dl>

<dl class="function">
<dt id="config.upload_new_models">
<code class="descclassname">config.</code><code class="descname">upload_new_models</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#config.upload_new_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by train_models() when a new model comes fresh out of training</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Welcome to Grassroot-NLU&#8217;s documentation!</a><ul>
<li><a class="reference internal" href="#getting-started-with-grassroot-nlu">Getting Started with Grassroot-NLU</a></li>
<li><a class="reference internal" href="#demo-client">Demo Client</a></li>
<li><a class="reference internal" href="#output">Output</a></li>
<li><a class="reference internal" href="#module-main">Core Functions</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Grassroot.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>